<project name="user" default="deploy" basedir=".">
    
	<target name="-init">
    	<available property="props" file="build.properties"/>
    	<fail unless="props">
    		Please copy build.properties.template to build.properties and update the settings.
    	</fail>
    	<loadproperties srcfile="build.properties"/>
        <property name="app" value="user"/>
    </target>
	
	<target name="-clean" depends="-init">
    	<delete file="${install.dir}/app - ${app}/resources/linked-root/css/customization.css"/>
	</target>
	
    <target name="deploy" depends="-init, -clean">
        <mkdir dir="deploy/${app}"/> 
        <mkdir dir="deploy/${app}/classes"/>
    	
    	<!-- Copy the classpath from the base application -->
        <copy todir="deploy/${app}/classes">
            <fileset dir="${install.dir}/app - ${app}/resources">
            	<exclude name="linked-root/**"/>
            	<exclude name="layout-pages/**"/>
            </fileset>            
            <fileset dir="${install.dir}/app - ${app}/src-gen/classes"/>
        	<fileset dir="${install.dir}/app - ${app}/src-gen" includes="com/**/*.class"/>
        </copy>

    	<!-- Usecases/I18N/services from the base application. -->
        <copy todir="deploy/${app}/">
        	<fileset dir="${install.dir}/app - ${app}/resources" includes="config.properties"/>
        	<fileset dir="${install.dir}/app - ${app}/resources" includes="services/*.xml"/>
            <fileset dir="${install.dir}/app - ${app}/src-gen"  includes="internationalization/*.properties"/>
        	<fileset dir="${install.dir}/app - ${app}/src-gen" includes="${app}.xml"/>
        	<fileset dir="${install.dir}/app - ${app}/src-gen" includes = "usecases/*.xml"/>
        </copy>

    	<!-- Copy the linked-root and layout-pages from the base application. -->
        <copy todir="deploy/${app}">
            <fileset dir="${install.dir}/app - ${app}/resources" includes="linked-root/**/*.*"/>
        	<fileset dir="${install.dir}/app - ${app}/resources" includes="layout-pages/**/*.*"/>
            <fileset dir="../1ffc - common" includes="linked-root/**/*"/>            
        </copy>

    	<!-- Duplicate the common linked-root for the b2c and admin login flows -->
    	<!-- Copy configuration for jetty -->
        <copy todir="deploy">
        	<fileset dir="${install.dir}/app - ${app}/deploy">
        		<include name="jndi.xml"/>
        		<include name="license"/>
        	</fileset>
        </copy>    	
    </target>
</project> 
